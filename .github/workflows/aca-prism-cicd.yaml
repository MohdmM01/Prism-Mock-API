# This is a basic workflow to help you get started with Actions
name: PRISM Mock API CICD Workflow

on:
  push:
    branches: 
    - master
  workflow_dispatch:

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
        -   name: Checkout
            uses: actions/checkout@v3

        # Log in to Azure CLI
        - name: Log in to Azure
          uses: azure/login@v1
          with:
            creds: ${{ secrets.AZURE_CREDENTIALS }}

        # Build and deploy the container app
        - name: Build and deploy Container App
          uses: azure/container-apps-deploy-action@v0
          with:
            appSourcePath: ${{ github.workspace }}
            registryUrl: mytestregistry.dockerhub.io
            registryUsername: ${{ secrets.DOCKERHUB_USERNAME }}
            registryPassword: ${{ secrets.DOCKERHUB_TOKEN }}
            containerAppName: <Container-App-Name>
            containerAppEnvironment: <Container-App-Environment-Name>
            resourceGroup: <Container-App-Resource-Group>
            imageToBuild: <Container-Registry>/<Image-Name>:<Tag e.g. ${{ github.sha }}>
            dockerfilePath: /Path/to/Dockerfile
        
        
